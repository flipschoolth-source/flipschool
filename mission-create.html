<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mission Create | AI Magic Canvas</title>

<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600&family=Sarabun:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body{margin:0;font-family:Sarabun;background:#f2f4f7}
header{
  background:linear-gradient(135deg,#141e30,#243b55);
  color:#fff;text-align:center;
  padding:35px 20px 70px;
  border-radius:0 0 50px 50px
}
main{
  max-width:1400px;margin:-40px auto 40px;
  padding:0 20px;
  display:grid;grid-template-columns:1fr 460px;gap:25px
}
@media(max-width:1024px){main{grid-template-columns:1fr}}
.card{
  background:#fff;border-radius:30px;padding:25px;
  box-shadow:0 15px 35px rgba(0,0,0,.08);
  margin-bottom:20px
}
label{font-family:Kanit;font-weight:500;margin-bottom:8px;display:block}
input,textarea{
  width:100%;padding:14px;border-radius:14px;
  border:1px solid #ddd;font-size:15px
}
button{
  width:100%;padding:14px;border:none;
  border-radius:14px;background:#8e44ad;
  color:#fff;font-family:Kanit;font-size:16px;
  cursor:pointer;display:flex;gap:10px;
  justify-content:center;align-items:center
}
button.secondary{background:#34495e}
.api-status{display:flex;gap:8px;font-size:13px;margin-bottom:12px}
.dot{width:10px;height:10px;border-radius:50%;background:#bbb}
.dot.on{background:#2ecc71;box-shadow:0 0 8px #2ecc71}
.phone{
  background:#111;border-radius:55px;padding:15px;
  height:760px;position:sticky;top:20px
}
.screen{background:#fff;border-radius:40px;height:100%;overflow:hidden}
iframe{width:100%;height:100%;border:none}
#loadingOverlay{
  position:fixed;inset:0;
  background:rgba(255,255,255,.85);
  display:none;align-items:center;justify-content:center;z-index:9999
}
.spinner{
  width:48px;height:48px;border:5px solid #eee;
  border-top-color:#8e44ad;border-radius:50%;
  animation:spin 1s linear infinite
}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>

<body>

<div id="loadingOverlay"><div class="spinner"></div></div>

<header>
  <h1 style="font-family:Kanit;margin:0">Mission Create ‚ú®</h1>
  <p>AI Magic Canvas (Stable API)</p>
</header>

<main>

<section>

<div class="card">
  <div class="api-status">
    <div id="dot" class="dot"></div>
    <span id="statusText">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö API</span>
  </div>

  <label>üîë Gemini API Key</label>
  <input type="password" id="geminiKey" placeholder="AIzaSy...">
  <button class="secondary" onclick="testKey()">‡∏ó‡∏î‡∏™‡∏≠‡∏ö API Key</button>
</div>

<div class="card">
  <label>ü§ñ ‡πÇ‡∏°‡πÄ‡∏î‡∏•</label>
  <input value="gemini-1.0-pro (Stable)" disabled>
</div>

<div class="card">
  <label>üé® ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∑‡πà‡∏≠</label>
  <textarea id="prompt" rows="6"></textarea>
  <button onclick="generate()">
    <i class="fas fa-wand-magic-sparkles"></i> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏∑‡πà‡∏≠
  </button>
</div>

</section>

<aside>

<div class="phone">
  <div class="screen">
    <iframe id="preview"
      srcdoc="<body style='display:flex;align-items:center;justify-content:center;height:100vh;color:#aaa'>Preview</body>">
    </iframe>
  </div>
</div>

</aside>

</main>

<script>
const API_BASE = "https://generativelanguage.googleapis.com/v1";
const MODEL = "gemini-1.0-pro";

function loading(v){
  document.getElementById("loadingOverlay").style.display = v?"flex":"none";
}

async function testKey(){
  const key = geminiKey.value.trim();
  if(!key) return alert("‡πÉ‡∏™‡πà API Key ‡∏Å‡πà‡∏≠‡∏ô");

  loading(true);
  try{
    const r = await fetch(
      `${API_BASE}/models/${MODEL}:generateContent?key=${key}`,
      {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({
          contents:[{parts:[{text:"ping"}]}]
        })
      }
    );
    const j = await r.json();
    if(j.error) throw j.error;

    dot.classList.add("on");
    statusText.textContent = "API ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ ‚úî";
  }catch(e){
    dot.classList.remove("on");
    statusText.textContent = "API ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‚ùå";
    alert(e.message);
  }
  loading(false);
}

async function generate(){
  const key = geminiKey.value.trim();
  const text = prompt.value.trim();
  if(!key||!text) return alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö");

  loading(true);
  preview.srcdoc="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á...";

  const r = await fetch(
    `${API_BASE}/models/${MODEL}:generateContent?key=${key}`,
    {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        contents:[{parts:[{text:text}]}]
      })
    }
  );
  const j = await r.json();
  preview.srcdoc = j.candidates[0].content.parts[0].text;
  loading(false);
}
</script>

</body>
</html>
